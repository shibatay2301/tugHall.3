---
title: "Drug intervention"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Drug intervention}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}

---


```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
  
)
```


# Table of Contents

[User Guide content](A_User_Guide.html)

[Theory of the model](B_Theory.html)

[Quick start guide](C_Quick_start.html)

[Simulation preparation](D_Simulation.html)

[Input data](E_Input.html)

[Output data](F_Output.html)

[Post simulation analisys](G_Analisys.html)

[VAF calculation](H_VAF.html)

[Figures](I_Figures.html)

[Relation to experimental measurements](J_Relation.html)

[Versions](K_Versions.html)

[Drug interventions](L_Drug_interventions.html)

[References](M_References.html)

---

# Drug intervention       
        
After standard simulation, drug intervention includes the following steps:


1. Drug intervention trials

2. Plot the results of simulation after drug intervention

3. check the blocking drivers and plot the results


---
Load the tugHall.3 simulation package:

```{r, echo=TRUE}
library(tugHall.3)
```
            

### 1. Drug intervention trials

Please follow the D_simulation for tugHall.3 simulation, before moving to drug intervention. One can use the result of simulation for drug intervention using this specific function. 

Here, two kind of probabilities are being used, "kill_prob" and "block_prob".  "kill_prob" is the probability of killing cancer cells corresponding to the malfunctioned gene. "block_prob" is the probability of blocking cancer cells corresponding to the malfunctioned gene. "gene" is the name of target gene to kill and block tumor cells by a drug. Here, the gene should be selected from the simulation results and one should check the target gene in the 'VAF_data.txt' file.


```{r, echo=TRUE}
load_tugHall.Environment( results = tugHall_dataset )
drug_intervention( kill_prob = 0, block_prob = 0.5, gene = "KRAS" )
env = tugHall_dataset$env 
clones = tugHall_dataset$clones
pnt_clones = tugHall_dataset$pnt_clones
        vf_drug  =  get_VAF_clones( env, clones, pnt_clones)
        VAF_drug  =  get_rho_VAF( vf = vf_drug, save_to_file = FALSE )
```



## 2. Plot the results of simulation after drug intervention

To visualize results of a simulation after using drug intervention to target a gene, one may plot them using special function:

```{r, echo=TRUE, fig.height=6, fig.width=6}
plot_VAF( VAF = VAF_drug, rho = 0, violin = FALSE )
```




### 3. check the blocking drivers and plot the results

Here one can check the blocking drivers which will be moved to passengers after drug intervention.

```{r, echo=TRUE}
vf_drivers  =  vf_drug[ which(  vf_drug$MalfunctionedByPointMut ), ]
vf_pass     =  vf_drug[ which( !vf_drug$MalfunctionedByPointMut ), ]
VAF_drivers  =  get_rho_VAF( vf = vf_drivers, save_to_file = FALSE )
VAF_pass  =  get_rho_VAF( vf = vf_pass, save_to_file = FALSE)
```
        


To visualize the results of simulation after drug intervention for drivers and passengers separately, one can use the specific function:
    
```{r, echo=TRUE, fig.height=6, fig.width=6}
if (length(VAF_drivers) > 0 ) plot_VAF( VAF = VAF_drivers, rho = 0 , violin = FALSE )
if (length(VAF_pass) > 0 ) plot_VAF( VAF = VAF_pass, rho = 0 , violin = FALSE )
```
            
            
            
            

